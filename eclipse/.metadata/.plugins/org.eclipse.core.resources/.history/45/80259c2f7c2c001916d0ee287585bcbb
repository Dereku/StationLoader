package net.modificationstation.stationloader.loaders;

import java.io.File;
import java.net.URL;
import java.net.URLClassLoader;
import java.util.jar.JarFile;

import net.minecraft.client.Minecraft;
import net.modificationstation.stationloader.StationLoader;
import net.modificationstation.stationloader.util.Mod;

public class Loader {
    private Loader() {
    }
	public void loadMods() {
        File modsFolder = new File(Minecraft.getMinecraftDir() + "/mods/");
        if (!modsFolder.exists()) {modsFolder.mkdir();}
        File[] mods = modsFolder.listFiles();
        for (int i = 0; i < mods.length; i++){
            try {
			    File modFile = mods[i];
			    ClassLoader loader = URLClassLoader.newInstance(
			            new URL[] { modFile.toURI().toURL() },
			            getClass().getClassLoader()
			        );
			    JarFile modJar = new JarFile(modFile);
			    String modClasses = modJar.entries();
			    Class<?> clazz = Class.forName("net.mine_diver.testmod.TestMod", true, loader);
			    Mod mod = clazz.getAnnotation(Mod.class);
			    StationLoader.addMod(clazz);
			    System.out.println(mod.modid());
		    } catch (Exception e) {};
        }
	}
	public final static Loader INSTANCE = new Loader();
}
